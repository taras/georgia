name: TNP Merge

on:
  push:
    branches:
      - release-*
      
jobs:
  # tests:
  #   name: Run Tests
  #   runs-on: ubuntu-latest
  #   steps:
  #   - uses: actions/checkout@master
  #   - name: yarn
  #     run: yarn
  #   - name: test
  #     run: yarn test 

  publish:
    name: Commit & Publish
    runs-on: ubuntu-latest
    #needs: tests
    steps:
    - uses: actions/checkout@v1
    
    # - name: Filter by Commit Message
    #   uses: taras/georgia/.github/actions/filter-by-commit@release-1.0.0
    #   with:
    #     filter: skip-actions

    - name: someone else's filter
      uses: veggiemonk/skip-commit@master
      env:
        COMMIT_FILTER: hello

    - name: list labels of last merged pr
      uses: minkimcello/js-action@master
      id: pr-labels
      with:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    - name: filter separately (beta)
      uses: minkimcello/label-sorter@master
      id: filter-labels
      with:
        LABELS: ${{ steps.pr-labels.outputs.result }}

    - run: echo $NPM_VERSION
    
    # - name: npm version using label variable set from previous step
    #   uses: actions/npm@master
    #   with:
    #     args: version $NPM_VERSION --no-git-tag-version

    # - name: commit and push to repo
    #   uses: taras/georgia/.github/actions/git-push@release-1.0.0
    #   with:
    #     add: package.json
    #   env:
    #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    
    # - name: publish
    #   uses: actions/npm@master
    #   with:
    #     args: publish --access=public
    #   env:
    #     NPM_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }}